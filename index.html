<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ocene</title>
    <link rel="icon" href="Lg.png" type="image/png" />
    <style>
        body {
            font-family: 'Aptos Narrow', sans-serif;
            margin: 20px;
        }
        select {
            font-family: 'Aptos Narrow', sans-serif;
            padding: 5px 10px;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .kratica {
            font-weight: bold;
        }
        .pisna-ocena { color: red; font-weight: bold; cursor: pointer; }
        .ustna-ocena { color: blue; font-weight: bold; cursor: pointer; }
        .koncna-ocena { color: green; font-weight: bold; cursor: pointer; }
        .izdelek-ocena { color: purple; font-weight: bold; cursor: pointer; }
        .zakljucna-ocena { color: black; font-weight: bold; font-size: 1.2em; cursor: pointer; }
        .pisna-ocena:hover, .ustna-ocena:hover, .koncna-ocena:hover, .izdelek-ocena:hover, .zakljucna-ocena:hover {
            text-decoration: underline;
        }
        .stara-ocena {
            color: grey;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <h1>OCENE</h1>

    <label for="tipOcene">Izberite tip ocene:</label>
    <select id="tipOcene">
        <option value="pisna">Pisna ocena</option>
        <option value="ustna">Ustna ocena</option>
        <option value="koncna">Končna ocena</option>
        <option value="izdelek">Izdelek</option>
        <option value="zakljucna">Zaključna ocena</option>
    </select>

    <table id="oceneTabela">
        <thead>
            <tr>
                <th>Predmet</th>
                <th>Prvo ocenjevalno obdobje</th>
                <th>Drugo ocenjevalno obdobje</th>
                <th>Konec</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const predmeti = [
            { kratica: "SLO", naziv: "Slovenščina" },
            { kratica: "MAT", naziv: "Matematika" },
            { kratica: "ANJ", naziv: "Angleščina" },
            { kratica: "UME", naziv: "Umetnost" },
            { kratica: "ZGO", naziv: "Zgodovina" },
            { kratica: "GEO", naziv: "Geografija" },
            { kratica: "FIZ", naziv: "Fizika" },
            { kratica: "KEM", naziv: "Kemija" },
            { kratica: "ŠVZ", naziv: "Športna vzgoja" },
            { kratica: "GOB", naziv: "Grafično oblikovanje" },
            { kratica: "GMP", naziv: "Grafični in medijski procesi" },
            { kratica: "IKT", naziv: "Informacijsko komunikacijska tehnologija" },
            { kratica: "IPM", naziv: "Izbrana poglavja matematike" },
            { kratica: "NEJ", naziv: "Nemščina" },
        ];

        const tabela = document.querySelector("#oceneTabela tbody");
        const tipOceneSelect = document.getElementById("tipOcene");

        function shraniOcene(ocene) {
            localStorage.setItem("ocene", JSON.stringify(ocene));
        }

        function naloziOcene() {
            return JSON.parse(localStorage.getItem("ocene")) || {};
        }

        function izrisiOcene() {
            const ocene = naloziOcene();
            tabela.innerHTML = "";

            predmeti.forEach(predmet => {
                const row = tabela.insertRow();
                row.insertCell().innerHTML = `<span class="kratica">${predmet.kratica}</span><br>${predmet.naziv}`;
                for (let i = 1; i <= 3; i++) {
                    const td = row.insertCell();
                    td.classList.add("editable");
                    td.dataset.predmet = predmet.kratica;
                    td.dataset.stolpec = i;
                    const celicneOcene = ocene[predmet.kratica]?.[i] || [];
                    celicneOcene.forEach(ocena => {
                        const span = document.createElement("span");
                        span.className = `${ocena.tip}-ocena`;
                        span.textContent = ocena.vrednost;
                        td.appendChild(span);
                        td.appendChild(document.createTextNode(" "));
                    });
                }
            });
        }

        function dodajOceno(predmet, stolpec, tip, vrednost) {
            const ocene = naloziOcene();
            if (!ocene[predmet]) ocene[predmet] = {};
            if (!ocene[predmet][stolpec]) ocene[predmet][stolpec] = [];
            ocene[predmet][stolpec].push({ tip, vrednost });
            shraniOcene(ocene);
            izrisiOcene();
        }

        function odstraniAliUredi(span) {
            const stara = span.textContent;
            const predmet = span.closest("td").dataset.predmet;
            const stolpec = span.closest("td").dataset.stolpec;
            const tip = span.className.split("-")[0];
            const ocene = naloziOcene();
            const oceneVPolju = ocene[predmet]?.[stolpec] || [];

            const index = oceneVPolju.findIndex(o => o.tip === tip && o.vrednost === stara);
            if (index === -1) return;

            const akcija = prompt(`OCENA: ${stara}\nKAJ ŽELITE NAREDITI?\n1. IZBRISATI\n2. UREDITI OCENO`);
            if (akcija === "1") {
                oceneVPolju.splice(index, 1);
            } else if (akcija === "2") {
                const nova = prompt("VNESITE NOVO OCENO:");
                if (nova) oceneVPolju[index].vrednost = nova;
            }

            shraniOcene(ocene);
            izrisiOcene();
        }

        tabela.addEventListener("click", (event) => {
            const target = event.target;

            if (target.matches(".pisna-ocena, .ustna-ocena, .koncna-ocena, .izdelek-ocena, .zakljucna-ocena")) {
                odstraniAliUredi(target);
            }

            if (target.classList.contains("editable")) {
                const tip = tipOceneSelect.value;
                const predmet = target.dataset.predmet;
                const stolpec = target.dataset.stolpec;
                const vrednost = prompt("Vnesite oceno:");
                if (vrednost) {
                    const potrditev = confirm("ALI ŽELITE VPISATI OCENO?");
                    if (potrditev) {
                        dodajOceno(predmet, stolpec, tip, vrednost);
                    }
                }
            }
        });

        izrisiOcene();
    </script>
</body>
</html>

